dist: xenial

services: docker

language: python

env:
 - PY_VERSION="!!--NO PYTHON VERSION DEFINED--!!"

jobs:
  include:
    # Python-version-tests has three (3) parallel jobs mainly.
    # Maily because of we want to test the compatibility of the app
    # with three different python versions.
    - stage: python-version-tests
      python: "2.7"
      env:
        - PY_VERSION=27
          TEST_SUITE=test_calc.py
    - # parallel job in python-version-tests stage
      python: "3.7"
      env:
        - PY_VERSION=37
          TEST_SUITE=test_calc.py
          HELLO="Hello from python version 3.7 build"
    - # parallel job in python-version-tests stage
      python: "3.8"
      env: 
        - PY_VERSION=38
          TEST_SUITE=test_calc.py
    - stage: deploy
      python: "3.7"
      env: 
        - PY_VERSION=37
          TEST_SUITE=test_calc.py

before_script:
  - echo $PY_VERSION
  - if [ $PY_VERSION == "37" ]; then
      echo $HELLO;
    fi

script: python $TEST_SUITE

stages:
  # stages are executed in the following order
  - python-version-tests
  - container-tests
  - name: deploy # run deploy build only in master branch
    if: branch = master

notifications:
    email: false